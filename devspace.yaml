name: capvc-controller
version: v2beta1

vars:
  IMAGE: gcr.io/spectro-common-dev/tylergillson/cluster-api-provider-virtual/virtual-controller

images:
  capvc-controller:
    createPullSecret: false
    dockerfile: ./Dockerfile.dev
    image: ${IMAGE}
    tags:
    - dev
    rebuildStrategy: ignoreContextChanges
    build:
      docker:
        #args:
        #- "--no-cache"
        useBuildKit: true

deployments:
  capvc-controller:
    namespace: cluster-63078898a671a598d086962e
    kubectl:
      kustomize: true
      manifests:
      - config/devspace

dev:
  capvc-controller:
    imageSelector: ${IMAGE}
    terminal:
      enabled: true
      disableReplace: true
      workDir: /
      command: ./devspace_start.sh
    ports:
    - port: "2345"
    sync:
    - path: .:/
      excludePaths:
        - '**'
        - '!/pkg'
        - '!/api'
        - '!/controllers'
        - '!/vendor'
        - '!/hack'
        - '!/config'
        - '!/go.mod'
        - '!/go.sum'
        - '!/devspace_start.sh'
        - 'Makefile'
